!function(e){"use strict";var r={protocol:"https",domain:"mite.yo.lk",async:!0,timeout:60,error:function(e,r){alert("Error: mite.gyver could not connect with your mite.account!")}},t=function(){},n=function(e){return/^\s*$/.test(e)?{}:JSON.parse(e)},o=function(e){return"function"==typeof e&&(e={success:e}),e||{}},u=function(e){for(var r=1,t=arguments.length;r<t;r++)for(var n in arguments[r])e[n]=arguments[r][n];return e};e.Mite=function(e){if(!e||!e.account||!e.api_key)throw"account & api_key need to be set";var i=u({},r,e),s={},c={},a=function(e){return i.protocol+"://corsapi."+i.domain+"/"+e+".json"},f=function(e,r,o){var u,a=new XMLHttpRequest,f=o.data||null,l="boolean"==typeof o.async?o.async:i.async,p=o.timeout||i.timeout,_=function(e){var r=e.success||t,o=e.error||i.error,u=e.complete||t,s={success:null,error:null,complete:null};return/2\d\d/.test(a.status)?a.responseText?(s.success=[n(a.responseText)],r(s.success[0])):(s.error=[a,"error"],o(a,"error")):(s.error=[a,a.responseText||"error"],o(a,a.responseText||"error")),s.complete=a,u(a),s};if(a.onreadystatechange=function(){if(4==a.readyState){if("GET"==e){for(var t=0;t<s[r].length;t++)c[r]=_(s[r][t]);delete s[r]}else _(o);clearTimeout(u)}},o.error&&(u=setTimeout((function(){error(a,"timeout")}),1e3*p)),a.open(e,r,l),f instanceof Object&&(f=JSON.stringify(f),a.setRequestHeader("Content-Type","application/json")),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-MiteApiKey",i.api_key),a.setRequestHeader("X-MiteAccount",i.account),a.send(f),!i.async)return n(a.responseText)},l=function(e,r,t){var n=o(t);return n.data=r,f("PUT",a(e),n)},p=function(e,r){return f("DELETE",a(e),o(r))},_=function(e){var r=function(r,t,n){var u,i=/\?/.test(r)?"&":"?";if(void 0===n?u=o(t):(u=o(n)).data=t,r=a(r),u.data&&(r+=i+function(e){if(!e||"String"==typeof e)return e||"";var r=[];for(var t in e)r.push("_queryString"==t?e[t]:[encodeURIComponent(t),encodeURIComponent(e[t])].join("="));return r.join("&")}(u.data),delete u.data),s[r])s[r].push(u);else{if(!e||!c[r])return s[r]=[u],f("GET",r,u);u.success&&c[r].success&&u.success.apply(null,c[r].success),u.error&&c[r].error&&u.error.apply(null,c[r].error),u.complete&&c[r].complete&&u.complete.apply(null,c[r].complete)}},t={_name:function(){return this._url.replace(/s$/,"").replace(/ie$/,"y")},_wrapParams:function(e){var r={};return r[this._name()]=e,r},all:function(e,t){return r(this._url,e,t)},find:function(e,t){return r(this._url+"/"+e,t)},create:function(e,r){return function(e,r,t){var n=o(t);return n.data=r,f("POST",a(e),n)}(this._url,this._wrapParams(e),r)},update:function(e,r,t){return l(this._url+"/"+e,this._wrapParams(r),t)},destroy:function(e,r){return p(this._url+"/"+e,r)}},n=u({all:void 0,active:t.all,archived:function(e,t){return r(this._url+"/archived",e,t)}},t),_={create:void 0,update:void 0,destroy:void 0};return{account:function(e){return r("account",e)},myself:function(e){return r("myself",e)},TimeEntry:u({_url:"time_entries"},t),Tracker:{find:function(e){return r("tracker",e)},start:function(e,r){return l("tracker/"+e,{},r)},stop:function(e,r){return p("tracker/"+e,r)}},Bookmark:u({_url:"time_entries/bookmarks",time_entries_for:function(e,t){return r(this._url+"/"+e+"/follow",t)}},t,_),Customer:u({_url:"customers",projects_for:function(e,t){return r("projects?customer_id="+e,t)},time_entries_for:function(e,t){return r("time_entries?customer_id="+e,t)}},n),Project:u({_url:"projects",time_entries_for:function(e,t){return r("time_entries?project_id="+e,t)}},n),Service:u({_url:"services",time_entries_for:function(e,t){return r("time_entries?service_id="+e,t)}},n),User:u({_url:"users",time_entries_for:function(e,t){return r("time_entries?user_id="+e,t)}},n,_),config:i,clearCache:function(e){this._url&&(e?c[e]=void 0:c={})}}};return u(_(),{cache:_(!0)})}}(window);